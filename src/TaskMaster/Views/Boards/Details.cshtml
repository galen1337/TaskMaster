@model Domain.Entities.Board

<h2>@Model.Name</h2>
<p>Project: <a asp-controller="Projects" asp-action="Details" asp-route-id="@Model.ProjectId">@Model.Project.Name</a></p>

<div class="row">
	@foreach (var col in Model.Columns.OrderBy(c => c.Order))
	{
		<div class="col-md-3">
			<div class="card mb-3">
				<div class="card-header">@col.Name</div>
				<ul class="list-group list-group-flush">
					@foreach (var card in Model.Cards.Where(c => c.ColumnId == col.Id).OrderBy(c => c.Priority))
					{
						<li class="list-group-item">
							<div class="fw-bold">@card.Title</div>
							<div class="text-muted small">@card.Priority</div>
							<form asp-controller="Cards" asp-action="Assign" method="post" class="d-flex gap-2 mt-2">
								<input type="hidden" name="id" value="@card.Id" />
								<select name="userId" class="form-select form-select-sm" style="max-width: 200px;">
									<option value="">Unassigned</option>
									@foreach (var m in Model.Project.Members)
									{
										<option value="@m.UserId" selected="@(card.AssigneeId == m.UserId)">@m.User.Email</option>
									}
								</select>
								<button type="submit" class="btn btn-sm btn-outline-secondary">Assign</button>
							</form>
						</li>
					}
				</ul>
			</div>
		</div>
	}
</div> 